我有一节课的期中作业是制作一个聊天室，要求能对话、传输文件、传输语音。

我想着要是直接用成熟框架比如Springboot+Web那有点太无趣了，于是乎我打算直接写裸的Socket。

一边写一边改，改到最后发现写出来的东西虽然简陋、但是自我感觉不同的层次之间封装的还挺好的，变成了一个框架的样子，于是乎我把框架的部分拆了出来，有了这个。

> 这个仓库不包含聊天室的后端业务逻辑和前端界面

---

现在的框架可以分为这几个层次：

- 数据协议层
  - 将基本数据类型包装，完成它们的序列化、反序列化
  - 保证数据完整性
  - 个别几个数据类型的数据分段（未完成）
- 业务逻辑框架层
  - 上层（业务逻辑层）需要将业务逻辑拆分成若干个独立的Task任务。由某一方发起一个请求（通过发送一个包含`"request"`字段的数据包）并在自己这一端建立Task，回复者在另一端建立对应的Task，两个Task之间进行通信来完成业务逻辑。
  - 回复者的上层（业务逻辑层）提前注册请求类型（请求类型用字符串作为唯一标识，类似于Web url的path）和对应的处理请求的回调函数，对远程主机发来的请求匹配到回调函数，在回调函数中完成对应Task的建立。
  - 每个Task有自己的Task id，业务逻辑框架层对数据层读取出来的包根据包内解析出来的Task id分发到对应的已建立的Task去处理
  - 有一个特殊的Task双方初始状态就存在，用于处理分段数据的发送和接收。上层在这个Task中注册接收新数据的回调函数或者注册分段数据的发送。通过这个Task在不损失太多性能的前提下完成分段数据传输细节的屏蔽。

现在用的BIO模型，未来还打算加入NIO。